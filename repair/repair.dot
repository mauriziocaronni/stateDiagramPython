digraph finite_state_machine {
    rankdir=TB;
    size="8,5"
    label="Repair"
    node [shape = box style=rounded]; 

    subgraph Opening {
        node [style =  filled shape = box]
	    label = "Opening";
		color=green
        VenditaRiparazione    
    }


subgraph cluster_riparazione {
    node [shape=box,style=rounded ];
    label = "RIPARAZIONE";

    subgraph cluster_gestore {
        node [shape=box,style=rounded ];
        label = "GESTORE";
        AvvioRiparazione
        ConfigurazioneRiparazione
        DefinizioneTimeline 
        AssegnazioneMonitoraggio
        VerificaChiusuraRiparazione
    }

    subgraph cluster_perito {
            node [shape=box,style=rounded ];
            label = "PERITO";
            MonitoraggioAttivita
            ApprovazioneBudget
            ApprovazioneAttivita
    }

    subgraph cluster_cat {
        node [shape=box,style=rounded ] ;
        label = "RIPARATORE";
        PianificazioneAppuntamentoR
        EsecuzioneSopralluogoR
        BudgetInApprovazione
        EsecuzioneAttivita 
        AttivitaInApprovazione
        AttivitaApprovata
        AttivitaCancellata
    }
    
}



	comment = "RIPARAZIONE"
	 
    VenditaRiparazione                    -> AvvioRiparazione            [ label = "RiparazioneVenduta" ]  ;

    comment = "sottoprocesso PianificazioneAttivita"


    AvvioRiparazione           -> ConfigurazioneRiparazione    [ label = "RiparazioneAvviata" ]  ;
    ConfigurazioneRiparazione  -> DefinizioneTimeline          [ label = "RiparazioneConfigurata" ]  ;
    DefinizioneTimeline        -> AssegnazioneMonitoraggio     [ label = "TimelineDefinita" ]  ;
    AssegnazioneMonitoraggio   -> VerificaChiusuraRiparazione  [ label = "MonitoraggioTerminato" ]  ;

    DefinizioneTimeline        -> PianificazioneAppuntamentoR  [ style = "dotted" ];
    AssegnazioneMonitoraggio   -> MonitoraggioAttivita         [ style = "dotted" label ="MonitoraggioAssegnato"];
    MonitoraggioAttivita       -> EsecuzioneSopralluogoR           [ style = "dotted" label = "annulla"];   

    comment = "sottoprocesso EsecuzioneAttivita"

    PianificazioneAppuntamentoR -> EsecuzioneSopralluogoR       [ label = "AppuntamentoPianificato" ];
    EsecuzioneSopralluogoR      -> AttivitaCancellata           [ label = "AttivitaCancellata" ];
    
    EsecuzioneSopralluogoR      -> ApprovazioneBudget           [ style = "dotted" ];
    EsecuzioneSopralluogoR      -> BudgetInApprovazione         [ label = "SoprallugoCompletato"]
    BudgetInApprovazione        -> EsecuzioneAttivita           [ label = "BudgetApprovato" ] 
    EsecuzioneAttivita          -> AttivitaInApprovazione       [ label = "AttivitaCompletata" ]
  
    AttivitaInApprovazione      -> AttivitaApprovata            [ label = "AttivitaApprovata" ]
    EsecuzioneAttivita           -> PianificazioneAppuntamentoR  [ label = "NuovoSopralluogo" ];
    AttivitaApprovata           -> MonitoraggioAttivita         [ style = "dotted" ]  ;

    ApprovazioneBudget          -> BudgetInApprovazione        [ style = "dotted" ]  ;
 	EsecuzioneAttivita          -> ApprovazioneAttivita          [ style = "dotted" ]  ;	
    ApprovazioneAttivita        -> AttivitaInApprovazione      [ style = "dotted" ]  ;

	
    MonitoraggioAttivita        ->  VerificaChiusuraRiparazione [ style = "dotted" ]  ;
    
	comment = "sottoprocesso Chiusura"
	node [shape=box,style=rounded  style = filled];
	color = grey
	
    VerificaChiusuraRiparazione  -> ConfigurazioneRiparazione    [ label = "RiparazioneNonChiusa" ] ;
    VerificaChiusuraRiparazione  -> PERIZIA            [ label = "PeriziaPostRiparazione" ];
    VerificaChiusuraRiparazione  -> CHIUSURA             [ label = "ChiusuraPostRiparazione" ];
    VerificaChiusuraRiparazione  -> DefinizioneTimeline    [ label = "DatiNonCompletati" ] ;
    

	
	
}